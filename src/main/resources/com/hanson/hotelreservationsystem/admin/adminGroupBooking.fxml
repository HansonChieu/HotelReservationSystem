<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.Spinner?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<BorderPane styleClass="admin-root" xmlns="http://javafx.com/javafx/25" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.hanson.hotelreservationsystem.controller.Admin.AdminGroupBookingController">
    <top>
        <HBox alignment="CENTER_LEFT" spacing="20" styleClass="form-header">
            <padding>
                <Insets bottom="15" left="20" right="20" top="15" />
            </padding>
            <children>
                <Button onAction="#handleCancel" styleClass="back-button" text="â† Back" />
                <Label styleClass="form-title" text="Group Booking">
                    <font>
                        <Font size="18.0" />
                    </font>
                </Label>
                <Region HBox.hgrow="ALWAYS" />
                <!-- Error label for validation messages -->
                <Label fx:id="errorLabel" styleClass="error-label" visible="false" />
            </children>
        </HBox>
    </top>
    <center>
        <ScrollPane fitToWidth="true" styleClass="form-scroll">
            <content>
                <VBox spacing="25" styleClass="form-content">
                    <padding>
                        <Insets bottom="25" left="30" right="30" top="25" />
                    </padding>
                    <children>
                        <!-- Group Information Section -->
                        <VBox spacing="15" styleClass="form-section">
                            <children>
                                <Label styleClass="section-header" text="ðŸ‘¥ Group Information" />
                                <Separator />
                                <GridPane hgap="20" vgap="15">
                                    <columnConstraints>
                                        <ColumnConstraints hgrow="SOMETIMES" percentWidth="50.0" />
                                        <ColumnConstraints hgrow="SOMETIMES" percentWidth="50.0" />
                                    </columnConstraints>
                                    <rowConstraints>
                                        <RowConstraints />
                                        <RowConstraints />
                                        <RowConstraints />
                                    </rowConstraints>
                                    <children>
                                        <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="0">
                                            <children>
                                                <HBox spacing="5">
                                                    <Label styleClass="field-label" text="Group Name" />
                                                    <Label styleClass="required" text="*" />
                                                </HBox>
                                                <TextField fx:id="groupNameField" promptText="e.g., Smith Family Reunion" styleClass="form-field" />
                                            </children>
                                        </VBox>
                                        <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                            <children>
                                                <HBox spacing="5">
                                                    <Label styleClass="field-label" text="Booking Type" />
                                                    <Label styleClass="required" text="*" />
                                                </HBox>
                                                <ComboBox fx:id="bookingTypeCombo" maxWidth="Infinity" promptText="Select booking type" styleClass="form-field" />
                                            </children>
                                        </VBox>
                                        <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="1">
                                            <children>
                                                <HBox spacing="5">
                                                    <Label styleClass="field-label" text="Organizer Name" />
                                                    <Label styleClass="required" text="*" />
                                                </HBox>
                                                <TextField fx:id="organizerNameField" promptText="Primary contact name" styleClass="form-field" />
                                            </children>
                                        </VBox>
                                        <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="1">
                                            <children>
                                                <HBox spacing="5">
                                                    <Label styleClass="field-label" text="Organizer Email" />
                                                    <Label styleClass="required" text="*" />
                                                </HBox>
                                                <TextField fx:id="organizerEmailField" promptText="email@example.com" styleClass="form-field" />
                                            </children>
                                        </VBox>
                                        <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="2">
                                            <children>
                                                <HBox spacing="5">
                                                    <Label styleClass="field-label" text="Organizer Phone" />
                                                    <Label styleClass="required" text="*" />
                                                </HBox>
                                                <TextField fx:id="organizerPhoneField" promptText="(555) 123-4567" styleClass="form-field" />
                                            </children>
                                        </VBox>
                                    </children>
                                </GridPane>
                                <VBox spacing="5">
                                    <children>
                                        <Label styleClass="field-label" text="Group Notes" />
                                        <TextArea fx:id="groupNotesArea" prefRowCount="2" promptText="Any special arrangements or notes for this group..." styleClass="form-textarea" wrapText="true" />
                                    </children>
                                </VBox>
                            </children>
                        </VBox>

                        <!-- Stay Details Section -->
                        <VBox spacing="15" styleClass="form-section">
                            <children>
                                <Label styleClass="section-header" text="ðŸ“… Stay Details" />
                                <Separator />
                                <GridPane hgap="20" vgap="15">
                                    <columnConstraints>
                                        <ColumnConstraints hgrow="SOMETIMES" percentWidth="33.3" />
                                        <ColumnConstraints hgrow="SOMETIMES" percentWidth="33.3" />
                                        <ColumnConstraints hgrow="SOMETIMES" percentWidth="33.3" />
                                    </columnConstraints>
                                    <rowConstraints>
                                        <RowConstraints />
                                    </rowConstraints>
                                    <children>
                                        <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="0">
                                            <children>
                                                <HBox spacing="5">
                                                    <Label styleClass="field-label" text="Check-In Date" />
                                                    <Label styleClass="required" text="*" />
                                                </HBox>
                                                <DatePicker fx:id="checkInPicker" maxWidth="Infinity" onAction="#handleDateChange" styleClass="form-field" />
                                            </children>
                                        </VBox>
                                        <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                            <children>
                                                <HBox spacing="5">
                                                    <Label styleClass="field-label" text="Check-Out Date" />
                                                    <Label styleClass="required" text="*" />
                                                </HBox>
                                                <DatePicker fx:id="checkOutPicker" maxWidth="Infinity" onAction="#handleDateChange" styleClass="form-field" />
                                            </children>
                                        </VBox>
                                        <VBox alignment="CENTER_LEFT" spacing="5" GridPane.columnIndex="2" GridPane.rowIndex="0">
                                            <children>
                                                <Label styleClass="field-label" text="Duration" />
                                                <Label fx:id="nightsLabel" styleClass="info-value large" text="0 nights" />
                                            </children>
                                        </VBox>
                                    </children>
                                </GridPane>
                            </children>
                        </VBox>

                        <!-- Room Selection Section -->
                        <VBox spacing="15" styleClass="form-section">
                            <children>
                                <Label styleClass="section-header" text="ðŸ›ï¸ Room Selection" />
                                <Separator />
                                <Label styleClass="info-text" text="Group Discount: 5% for 5-9 rooms, 10% for 10-19 rooms, 15% for 20+ rooms" />
                                <GridPane hgap="20" vgap="15">
                                    <columnConstraints>
                                        <ColumnConstraints hgrow="SOMETIMES" percentWidth="25.0" />
                                        <ColumnConstraints hgrow="SOMETIMES" percentWidth="25.0" />
                                        <ColumnConstraints hgrow="SOMETIMES" percentWidth="25.0" />
                                        <ColumnConstraints hgrow="SOMETIMES" percentWidth="25.0" />
                                    </columnConstraints>
                                    <rowConstraints>
                                        <RowConstraints />
                                        <RowConstraints />
                                    </rowConstraints>
                                    <children>
                                        <!-- Single Room -->
                                        <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="0">
                                            <children>
                                                <Label styleClass="field-label" text="Single Rooms" />
                                                <Spinner fx:id="singleRoomSpinner" editable="true" maxWidth="Infinity" />
                                                <Label fx:id="singleAvailabilityLabel" styleClass="availability-label" text="Available: --" />
                                            </children>
                                        </VBox>
                                        <!-- Double Room -->
                                        <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                            <children>
                                                <Label styleClass="field-label" text="Double Rooms" />
                                                <Spinner fx:id="doubleRoomSpinner" editable="true" maxWidth="Infinity" />
                                                <Label fx:id="doubleAvailabilityLabel" styleClass="availability-label" text="Available: --" />
                                            </children>
                                        </VBox>
                                        <!-- Deluxe Room -->
                                        <VBox spacing="5" GridPane.columnIndex="2" GridPane.rowIndex="0">
                                            <children>
                                                <Label styleClass="field-label" text="Deluxe Rooms" />
                                                <Spinner fx:id="deluxeRoomSpinner" editable="true" maxWidth="Infinity" />
                                                <Label fx:id="deluxeAvailabilityLabel" styleClass="availability-label" text="Available: --" />
                                            </children>
                                        </VBox>
                                        <!-- Penthouse -->
                                        <VBox spacing="5" GridPane.columnIndex="3" GridPane.rowIndex="0">
                                            <children>
                                                <Label styleClass="field-label" text="Penthouse Suites" />
                                                <Spinner fx:id="penthouseSpinner" editable="true" maxWidth="Infinity" />
                                                <Label fx:id="penthouseAvailabilityLabel" styleClass="availability-label" text="Available: --" />
                                            </children>
                                        </VBox>
                                        <!-- Summary Row -->
                                        <HBox alignment="CENTER_LEFT" spacing="20" GridPane.columnIndex="0" GridPane.columnSpan="4" GridPane.rowIndex="1">
                                            <children>
                                                <Label styleClass="field-label" text="Total Rooms:" />
                                                <Label fx:id="totalRoomsLabel" styleClass="info-value" text="0" />
                                                <Region prefWidth="30" />
                                                <Label styleClass="field-label" text="Total Guests:" />
                                                <Label fx:id="totalGuestsLabel" styleClass="info-value" text="0" />
                                            </children>
                                        </HBox>
                                    </children>
                                </GridPane>
                            </children>
                        </VBox>

                        <!-- Guest List Section -->
                        <VBox spacing="15" styleClass="form-section">
                            <children>
                                <HBox alignment="CENTER_LEFT" spacing="15">
                                    <children>
                                        <Label styleClass="section-header" text="ðŸ‘¤ Guest List" />
                                        <Region HBox.hgrow="ALWAYS" />
                                        <Button onAction="#handleAddGuest" styleClass="secondary-button small-button" text="+ Add Guest" />
                                        <Button onAction="#handleImportGuests" styleClass="secondary-button small-button" text="ðŸ“¥ Import CSV" />
                                    </children>
                                </HBox>
                                <Separator />
                                <TableView fx:id="guestTable" prefHeight="200" styleClass="data-table">
                                    <columns>
                                        <TableColumn fx:id="guestNameColumn" prefWidth="200" text="Guest Name" />
                                        <TableColumn fx:id="guestEmailColumn" prefWidth="200" text="Email" />
                                        <TableColumn fx:id="guestPhoneColumn" prefWidth="150" text="Phone" />
                                        <TableColumn fx:id="roomAssignmentColumn" prefWidth="150" text="Room Assignment" />
                                        <TableColumn fx:id="guestActionsColumn" prefWidth="100" text="Actions" />
                                    </columns>
                                    <placeholder>
                                        <VBox alignment="CENTER" spacing="10">
                                            <children>
                                                <Label styleClass="empty-icon" text="ðŸ‘¤" />
                                                <Label styleClass="empty-text" text="No guests added yet" />
                                                <Label styleClass="empty-hint" text="Click 'Add Guest' or 'Import CSV' to add guests" />
                                            </children>
                                        </VBox>
                                    </placeholder>
                                </TableView>
                            </children>
                        </VBox>

                        <!-- Pricing Summary Section -->
                        <VBox spacing="15" styleClass="form-section pricing-section">
                            <children>
                                <Label styleClass="section-header" text="ðŸ’° Pricing Summary" />
                                <Separator />
                                <GridPane hgap="30" vgap="12" styleClass="pricing-grid">
                                    <columnConstraints>
                                        <ColumnConstraints />
                                        <ColumnConstraints />
                                    </columnConstraints>
                                    <rowConstraints>
                                        <RowConstraints />
                                        <RowConstraints />
                                        <RowConstraints />
                                        <RowConstraints />
                                        <RowConstraints />
                                        <RowConstraints />
                                        <RowConstraints />
                                        <RowConstraints />
                                    </rowConstraints>
                                    <children>
                                        <Label styleClass="price-label" text="Room Subtotal:" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                                        <Label fx:id="roomSubtotalLabel" styleClass="price-value" text="\$0.00" GridPane.columnIndex="1" GridPane.rowIndex="0" />

                                        <Label styleClass="price-label discount-label" text="Group Discount:" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                                        <HBox alignment="CENTER_LEFT" spacing="10" GridPane.columnIndex="1" GridPane.rowIndex="1">
                                            <children>
                                                <Label fx:id="groupDiscountLabel" styleClass="price-value discount-percent" text="0%" />
                                                <Label fx:id="groupDiscountAmountLabel" styleClass="price-value discount" text="-$0.00" />
                                            </children>
                                        </HBox>

                                        <Label styleClass="price-label" text="Additional Discount:" GridPane.columnIndex="0" GridPane.rowIndex="2" />
                                        <HBox alignment="CENTER_LEFT" spacing="10" GridPane.columnIndex="1" GridPane.rowIndex="2">
                                            <children>
                                                <Spinner fx:id="additionalDiscountSpinner" editable="true" prefWidth="80" />
                                                <Label styleClass="price-label" text="%" />
                                                <Label fx:id="additionalDiscountAmountLabel" styleClass="price-value discount" text="-$0.00" />
                                            </children>
                                        </HBox>

                                        <Separator GridPane.columnIndex="0" GridPane.columnSpan="2" GridPane.rowIndex="3" />

                                        <Label styleClass="price-label" text="Subtotal:" GridPane.columnIndex="0" GridPane.rowIndex="4" />
                                        <Label fx:id="subtotalLabel" styleClass="price-value" text="\$0.00" GridPane.columnIndex="1" GridPane.rowIndex="4" />

                                        <Label styleClass="price-label" text="Tax (13%):" GridPane.columnIndex="0" GridPane.rowIndex="5" />
                                        <Label fx:id="taxLabel" styleClass="price-value" text="\$0.00" GridPane.columnIndex="1" GridPane.rowIndex="5" />

                                        <Separator styleClass="total-separator" GridPane.columnIndex="0" GridPane.columnSpan="2" GridPane.rowIndex="6" />

                                        <Label styleClass="price-label total-label" text="Total:" GridPane.columnIndex="0" GridPane.rowIndex="7" />
                                        <Label fx:id="totalLabel" styleClass="price-value total-value" text="\$0.00" GridPane.columnIndex="1" GridPane.rowIndex="7" />
                                    </children>
                                </GridPane>
                                <HBox alignment="CENTER_LEFT" spacing="10" styleClass="deposit-info">
                                    <children>
                                        <Label styleClass="info-label" text="âš ï¸ Deposit Required (20%):" />
                                        <Label fx:id="depositRequiredLabel" styleClass="info-value deposit" text="\$0.00" />
                                    </children>
                                </HBox>
                            </children>
                        </VBox>

                        <!-- Action Buttons -->
                        <HBox alignment="CENTER" spacing="15" styleClass="form-actions">
                            <children>
                                <Button onAction="#handleCancel" styleClass="cancel-button" text="Cancel" />
                                <Button onAction="#handleSaveQuote" styleClass="secondary-button" text="ðŸ’¾ Save Quote" />
                                <!-- Renamed to match controller: handleCreateBooking -->
                                <Button fx:id="createButton" onAction="#handleCreateBooking" styleClass="primary-button large-button" text="âœ“ Create Group Booking" />
                            </children>
                        </HBox>
                    </children>
                </VBox>
            </content>
        </ScrollPane>
    </center>
</BorderPane>
